<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ski Vakantie 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --snow: #F8FAFC;
            --ice: #E0F2FE;
            --glacier: #7DD3FC;
            --sky: #0EA5E9;
            --mountain: #1E293B;
            --shadow: #0F172A;
            --sunset: #F97316;
            --forest: #166534;
            --warning: #EAB308;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(180deg, var(--sky) 0%, var(--ice) 40%, var(--snow) 100%);
            min-height: 100vh;
            color: var(--shadow);
            position: relative;
            overflow-x: hidden;
        }

        /* Animated snow background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(2px 2px at 20% 30%, white, transparent),
                radial-gradient(2px 2px at 60% 70%, white, transparent),
                radial-gradient(1px 1px at 50% 50%, white, transparent),
                radial-gradient(1px 1px at 80% 10%, white, transparent),
                radial-gradient(2px 2px at 90% 60%, white, transparent),
                radial-gradient(1px 1px at 33% 80%, white, transparent),
                radial-gradient(1px 1px at 15% 65%, white, transparent);
            background-size: 200% 200%;
            background-position: 0% 0%;
            animation: snow 20s ease-in-out infinite;
            opacity: 0.3;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes snow {
            0%, 100% { background-position: 0% 0%; }
            50% { background-position: 100% 100%; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            animation: slideDown 0.8s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 5rem;
            letter-spacing: 0.15em;
            color: var(--shadow);
            text-shadow: 
                3px 3px 0 var(--glacier),
                6px 6px 0 var(--sky),
                9px 9px 20px rgba(0,0,0,0.3);
            margin-bottom: 0.5rem;
            animation: titlePulse 3s ease-in-out infinite;
        }

        @keyframes titlePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .subtitle {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--mountain);
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }

        .nav-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .tab-btn {
            background: white;
            border: 3px solid var(--mountain);
            padding: 1rem 2rem;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.5rem;
            letter-spacing: 0.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .tab-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--glacier);
            transition: left 0.3s ease;
            z-index: -1;
        }

        .tab-btn:hover::before,
        .tab-btn.active::before {
            left: 0;
        }

        .tab-btn.active {
            background: var(--glacier);
            border-color: var(--sky);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(14, 165, 233, 0.4);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border: 3px solid var(--mountain);
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 
                8px 8px 0 var(--glacier),
                12px 12px 0 var(--sky),
                16px 16px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translate(-2px, -2px);
            box-shadow: 
                10px 10px 0 var(--glacier),
                14px 14px 0 var(--sky),
                18px 18px 35px rgba(0,0,0,0.25);
        }

        .card h2 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2.5rem;
            letter-spacing: 0.1em;
            color: var(--mountain);
            margin-bottom: 1rem;
            border-bottom: 4px solid var(--sunset);
            padding-bottom: 0.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            font-weight: 800;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
            color: var(--mountain);
        }

        input[type="text"],
        input[type="date"],
        textarea,
        select {
            width: 100%;
            padding: 1rem;
            border: 3px solid var(--mountain);
            background: var(--snow);
            font-family: 'Montserrat', sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus,
        input[type="date"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: var(--sky);
            background: white;
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.2);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        .btn {
            background: var(--mountain);
            color: white;
            border: none;
            padding: 1rem 2.5rem;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.3rem;
            letter-spacing: 0.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 4px 4px 0 var(--shadow);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: var(--sunset);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.5s ease, height 0.5s ease;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn span {
            position: relative;
            z-index: 1;
        }

        .btn:hover {
            transform: translate(-2px, -2px);
            box-shadow: 6px 6px 0 var(--shadow);
        }

        .btn:active {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 var(--shadow);
        }

        .day-entry {
            border-left: 6px solid var(--glacier);
            padding-left: 1.5rem;
            margin-bottom: 2rem;
            position: relative;
        }

        .day-entry::before {
            content: '‚õ∑Ô∏è';
            position: absolute;
            left: -1.2rem;
            top: 0;
            font-size: 1.5rem;
            background: white;
        }

        .day-entry h3 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.8rem;
            letter-spacing: 0.05em;
            color: var(--sky);
            margin-bottom: 0.5rem;
        }

        .day-entry .date {
            font-weight: 600;
            color: var(--mountain);
            margin-bottom: 1rem;
        }

        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .photo-item {
            aspect-ratio: 1;
            background: var(--ice);
            border: 3px solid var(--mountain);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            transition: transform 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-item:hover {
            transform: scale(1.05) rotate(2deg);
            z-index: 10;
        }

        .run-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            margin-bottom: 1rem;
            background: var(--snow);
            border-left: 6px solid var(--forest);
            transition: all 0.3s ease;
        }

        .run-item:hover {
            background: white;
            border-left-width: 10px;
            transform: translateX(5px);
        }

        .run-item.black {
            border-left-color: var(--shadow);
        }

        .run-item.red {
            border-left-color: #DC2626;
        }

        .run-item.blue {
            border-left-color: var(--sky);
        }

        .run-name {
            font-weight: 800;
            font-size: 1.1rem;
            color: var(--mountain);
        }

        .run-difficulty {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            margin-left: 1rem;
        }

        .run-difficulty.black {
            background: var(--shadow);
            color: white;
        }

        .run-difficulty.red {
            background: #DC2626;
            color: white;
        }

        .run-difficulty.blue {
            background: var(--sky);
            color: white;
        }

        .run-difficulty.green {
            background: var(--forest);
            color: white;
        }

        .vote-btn {
            background: var(--warning);
            color: var(--shadow);
            border: 2px solid var(--mountain);
            padding: 0.5rem 1rem;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .vote-btn:hover {
            background: var(--sunset);
            transform: scale(1.1);
        }

        .vote-count {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.5rem;
            color: var(--sunset);
            margin-left: 1rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .stat-card {
            background: white;
            border: 3px solid var(--mountain);
            padding: 1.5rem;
            text-align: center;
            box-shadow: 4px 4px 0 var(--glacier);
        }

        .stat-number {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 3rem;
            color: var(--sunset);
            letter-spacing: 0.05em;
        }

        .stat-label {
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.9rem;
            color: var(--mountain);
            letter-spacing: 0.05em;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
        }

        .file-input-wrapper input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-label {
            display: inline-block;
            background: var(--glacier);
            color: var(--mountain);
            padding: 0.75rem 1.5rem;
            border: 3px solid var(--mountain);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-input-label:hover {
            background: var(--sky);
            color: white;
            transform: translateY(-2px);
        }

        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--mountain);
            font-style: italic;
        }

        .empty-state::before {
            content: '‚õ∑Ô∏è';
            display: block;
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.3;
        }

        footer {
            text-align: center;
            padding: 3rem 2rem;
            margin-top: 4rem;
            border-top: 4px solid var(--mountain);
            background: rgba(255, 255, 255, 0.9);
            position: relative;
        }

        footer::before {
            content: '‚õ∑Ô∏è';
            display: block;
            font-size: 2rem;
            margin-bottom: 1rem;
            animation: ski 3s ease-in-out infinite;
        }

        @keyframes ski {
            0%, 100% { transform: translateX(-10px) rotate(-5deg); }
            50% { transform: translateX(10px) rotate(5deg); }
        }

        .footer-text {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.5rem;
            letter-spacing: 0.1em;
            color: var(--mountain);
            margin-bottom: 0.5rem;
        }

        .footer-name {
            font-weight: 600;
            color: var(--sky);
            font-size: 0.9rem;
            letter-spacing: 0.05em;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 3rem;
            }
            
            .card {
                box-shadow: 
                    4px 4px 0 var(--glacier),
                    6px 6px 0 var(--sky),
                    8px 8px 20px rgba(0,0,0,0.2);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>SKI VAKANTIE</h1>
            <div class="subtitle">2026 Lofer</div>
            <div id="storage-mode" style="margin-top: 1rem; font-size: 0.8rem; opacity: 0.7;"></div>
        </header>

        <div class="nav-tabs">
            <button class="tab-btn active" onclick="showTab('dagboek')">
                <span>Dagboek</span>
            </button>
            <button class="tab-btn" onclick="showTab('runs')">
                <span>Runs</span>
            </button>
            <button class="tab-btn" onclick="showTab('voting')">
                <span>Beste Run</span>
            </button>
            <button class="tab-btn" onclick="showTab('stats')">
                <span>Stats</span>
            </button>
        </div>

        <!-- Dagboek Tab -->
        <div id="dagboek" class="tab-content active">
            <div class="card">
                <h2>Nieuwe Dag Toevoegen</h2>
                <form id="dagboek-form">
                    <div class="form-group">
                        <label>Datum</label>
                        <input type="date" id="dag-datum" required>
                    </div>
                    <div class="form-group">
                        <label>Titel van de Dag</label>
                        <input type="text" id="dag-titel" placeholder="Bijv. Epic powder dag!" required>
                    </div>
                    <div class="form-group">
                        <label>Verslag</label>
                        <textarea id="dag-verslag" placeholder="Wat hebben jullie gedaan? Hoe waren de condities?" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Foto's Toevoegen</label>
                        <div class="file-input-wrapper">
                            <input type="file" id="dag-fotos" accept="image/*" multiple>
                            <div class="file-input-label">üì∏ Kies Foto's</div>
                        </div>
                        <div id="foto-preview" class="photo-grid" style="margin-top: 1rem;"></div>
                    </div>
                    <button type="submit" class="btn">
                        <span>Dag Opslaan</span>
                    </button>
                </form>
            </div>

            <div class="card">
                <h2>Dagboek Overzicht</h2>
                <div id="dagboek-lijst"></div>
            </div>
        </div>

        <!-- Runs Tab -->
        <div id="runs" class="tab-content">
            <div class="card">
                <h2>Run Toevoegen</h2>
                <form id="run-form">
                    <div class="form-group">
                        <label>Run Naam</label>
                        <input type="text" id="run-naam" placeholder="Bijv. La Face" required>
                    </div>
                    <div class="form-group">
                        <label>Moeilijkheidsgraad</label>
                        <select id="run-difficulty" required>
                            <option value="">Kies...</option>
                            <option value="green">Groen - Makkelijk</option>
                            <option value="blue">Blauw - Gemiddeld</option>
                            <option value="red">Rood - Moeilijk</option>
                            <option value="black">Zwart - Expert</option>
                        </select>
                    </div>
                    <button type="submit" class="btn">
                        <span>Run Toevoegen</span>
                    </button>
                </form>
            </div>

            <div class="card">
                <h2>Onze Runs</h2>
                <div id="runs-lijst"></div>
            </div>
        </div>

        <!-- Voting Tab -->
        <div id="voting" class="tab-content">
            <div class="card">
                <h2>Stem op je Favoriete Run!</h2>
                <div id="voting-lijst"></div>
            </div>

            <div class="card">
                <h2>Resultaten</h2>
                <div id="voting-resultaten"></div>
            </div>
        </div>

        <!-- Stats Tab -->
        <div id="stats" class="tab-content">
            <div class="card">
                <h2>Vakantie Statistieken</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="stat-dagen">0</div>
                        <div class="stat-label">Dagen Geskied</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="stat-runs">0</div>
                        <div class="stat-label">Runs Gedaan</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="stat-fotos">0</div>
                        <div class="stat-label">Foto's</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="stat-votes">0</div>
                        <div class="stat-label">Stemmen</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-text">MADE FOR EPIC SKI DAYS</div>
        <div class="footer-name">Created by Thijs Quisenaerts</div>
    </footer>

    <script>
        // Storage helpers - with localStorage fallback
        const useCloudStorage = typeof window.storage !== 'undefined';
        
        async function saveData(key, data) {
            try {
                console.log('Saving data for key:', key, 'Data:', data);
                
                if (useCloudStorage) {
                    // Use Claude's shared storage
                    const result = await window.storage.set(key, JSON.stringify(data), true);
                    console.log('Save result (cloud):', result);
                    if (!result) {
                        throw new Error('Storage returned null');
                    }
                    return result;
                } else {
                    // Fallback to localStorage
                    localStorage.setItem(key, JSON.stringify(data));
                    console.log('Save result (localStorage): success');
                    return true;
                }
            } catch (error) {
                console.error('Error saving data:', error);
                throw error;
            }
        }

        async function loadData(key, defaultValue = null) {
            try {
                console.log('Loading data for key:', key);
                
                if (useCloudStorage) {
                    // Use Claude's shared storage
                    const result = await window.storage.get(key, true);
                    console.log('Load result (cloud):', result);
                    if (result && result.value) {
                        return JSON.parse(result.value);
                    }
                    return defaultValue;
                } else {
                    // Fallback to localStorage
                    const data = localStorage.getItem(key);
                    console.log('Load result (localStorage):', data);
                    return data ? JSON.parse(data) : defaultValue;
                }
            } catch (error) {
                console.log('Key not found or error loading:', key, error);
                return defaultValue;
            }
        }

        // Tab switching
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            event.target.closest('.tab-btn').classList.add('active');
            
            if (tabName === 'stats') {
                updateStats();
            } else if (tabName === 'voting') {
                renderVoting();
            }
        }

        // Dagboek functions
        let dagboekEntries = [];
        let photoFiles = [];

        document.getElementById('dag-fotos').addEventListener('change', function(e) {
            const preview = document.getElementById('foto-preview');
            preview.innerHTML = '';
            photoFiles = Array.from(e.target.files);
            
            photoFiles.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('div');
                    img.className = 'photo-item';
                    img.innerHTML = `<img src="${e.target.result}" alt="Foto ${index + 1}">`;
                    preview.appendChild(img);
                };
                reader.readAsDataURL(file);
            });
        });

        document.getElementById('dagboek-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            try {
                const photos = [];
                for (let file of photoFiles) {
                    const reader = new FileReader();
                    const dataUrl = await new Promise((resolve) => {
                        reader.onload = (e) => resolve(e.target.result);
                        reader.readAsDataURL(file);
                    });
                    photos.push(dataUrl);
                }
                
                const entry = {
                    id: Date.now(),
                    datum: document.getElementById('dag-datum').value,
                    titel: document.getElementById('dag-titel').value,
                    verslag: document.getElementById('dag-verslag').value,
                    fotos: photos
                };
                
                console.log('Saving entry:', entry);
                dagboekEntries = await loadData('dagboek', []);
                dagboekEntries.unshift(entry);
                await saveData('dagboek', dagboekEntries);
                console.log('Entry saved successfully!');
                
                this.reset();
                document.getElementById('foto-preview').innerHTML = '';
                photoFiles = [];
                
                // Show success message
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn.innerHTML;
                submitBtn.innerHTML = '<span>‚úÖ Opgeslagen!</span>';
                submitBtn.style.background = 'var(--forest)';
                
                setTimeout(() => {
                    submitBtn.innerHTML = originalText;
                    submitBtn.style.background = '';
                }, 2000);
                
                await renderDagboek();
            } catch (error) {
                console.error('Error saving entry:', error);
                alert('Er ging iets mis bij het opslaan. Probeer het opnieuw.');
            }
        });

        async function renderDagboek() {
            dagboekEntries = await loadData('dagboek', []);
            const lijst = document.getElementById('dagboek-lijst');
            
            if (dagboekEntries.length === 0) {
                lijst.innerHTML = '<div class="empty-state">Nog geen dagboek entries. Voeg je eerste ski-dag toe!</div>';
                return;
            }
            
            lijst.innerHTML = dagboekEntries.map(entry => `
                <div class="day-entry">
                    <h3>${entry.titel}</h3>
                    <div class="date">${new Date(entry.datum).toLocaleDateString('nl-NL', { 
                        weekday: 'long', 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric' 
                    })}</div>
                    <p style="margin-bottom: 1rem; line-height: 1.6;">${entry.verslag}</p>
                    ${entry.fotos.length > 0 ? `
                        <div class="photo-grid">
                            ${entry.fotos.map((foto, i) => `
                                <div class="photo-item">
                                    <img src="${foto}" alt="Foto ${i + 1}">
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        // Runs functions
        let runs = [];

        document.getElementById('run-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const run = {
                id: Date.now(),
                naam: document.getElementById('run-naam').value,
                difficulty: document.getElementById('run-difficulty').value,
                votes: 0
            };
            
            runs = await loadData('runs', []);
            runs.push(run);
            await saveData('runs', runs);
            
            this.reset();
            renderRuns();
        });

        async function renderRuns() {
            runs = await loadData('runs', []);
            const lijst = document.getElementById('runs-lijst');
            
            if (runs.length === 0) {
                lijst.innerHTML = '<div class="empty-state">Nog geen runs toegevoegd. Voeg je eerste piste toe!</div>';
                return;
            }
            
            const difficultyLabels = {
                green: 'Groen',
                blue: 'Blauw',
                red: 'Rood',
                black: 'Zwart'
            };
            
            lijst.innerHTML = runs.map(run => `
                <div class="run-item ${run.difficulty}">
                    <div>
                        <span class="run-name">${run.naam}</span>
                        <span class="run-difficulty ${run.difficulty}">${difficultyLabels[run.difficulty]}</span>
                    </div>
                </div>
            `).join('');
        }

        // Voting functions
        async function renderVoting() {
            runs = await loadData('runs', []);
            const votingLijst = document.getElementById('voting-lijst');
            const resultatenDiv = document.getElementById('voting-resultaten');
            
            if (runs.length === 0) {
                votingLijst.innerHTML = '<div class="empty-state">Voeg eerst runs toe om te kunnen stemmen!</div>';
                resultatenDiv.innerHTML = '';
                return;
            }
            
            const difficultyLabels = {
                green: 'Groen',
                blue: 'Blauw',
                red: 'Rood',
                black: 'Zwart'
            };
            
            votingLijst.innerHTML = runs.map(run => `
                <div class="run-item ${run.difficulty}">
                    <div>
                        <span class="run-name">${run.naam}</span>
                        <span class="run-difficulty ${run.difficulty}">${difficultyLabels[run.difficulty]}</span>
                    </div>
                    <div>
                        <button class="vote-btn" onclick="vote(${run.id})">
                            <span>üëç Stem</span>
                        </button>
                        <span class="vote-count">${run.votes}</span>
                    </div>
                </div>
            `).join('');
            
            // Show results sorted by votes
            const sortedRuns = [...runs].sort((a, b) => b.votes - a.votes);
            resultatenDiv.innerHTML = sortedRuns.slice(0, 5).map((run, index) => {
                const medals = ['ü•á', 'ü•à', 'ü•â'];
                const medal = index < 3 ? medals[index] : `${index + 1}.`;
                return `
                    <div class="run-item ${run.difficulty}" style="margin-bottom: 1rem;">
                        <div>
                            <span style="font-size: 1.5rem; margin-right: 1rem;">${medal}</span>
                            <span class="run-name">${run.naam}</span>
                            <span class="run-difficulty ${run.difficulty}">${difficultyLabels[run.difficulty]}</span>
                        </div>
                        <span class="vote-count">${run.votes}</span>
                    </div>
                `;
            }).join('');
        }

        async function vote(runId) {
            runs = await loadData('runs', []);
            const run = runs.find(r => r.id === runId);
            if (run) {
                run.votes++;
                await saveData('runs', runs);
                renderVoting();
            }
        }

        // Stats functions
        async function updateStats() {
            dagboekEntries = await loadData('dagboek', []);
            runs = await loadData('runs', []);
            
            const totalFotos = dagboekEntries.reduce((sum, entry) => sum + entry.fotos.length, 0);
            const totalVotes = runs.reduce((sum, run) => sum + run.votes, 0);
            
            document.getElementById('stat-dagen').textContent = dagboekEntries.length;
            document.getElementById('stat-runs').textContent = runs.length;
            document.getElementById('stat-fotos').textContent = totalFotos;
            document.getElementById('stat-votes').textContent = totalVotes;
        }

        // Initialize
        async function init() {
            // Show which storage mode is active
            const storageMode = document.getElementById('storage-mode');
            if (useCloudStorage) {
                storageMode.textContent = '‚òÅÔ∏è Gedeelde Cloud Opslag Actief - Iedereen ziet dezelfde data';
                storageMode.style.color = 'var(--forest)';
            } else {
                storageMode.textContent = 'üíæ Lokale Opslag Actief - Data alleen op dit apparaat';
                storageMode.style.color = 'var(--sunset)';
            }
            
            await renderDagboek();
            await renderRuns();
            await updateStats();
            
            // Set today's date as default
            document.getElementById('dag-datum').valueAsDate = new Date();
        }

        init();
    </script>
</body>
</html>
